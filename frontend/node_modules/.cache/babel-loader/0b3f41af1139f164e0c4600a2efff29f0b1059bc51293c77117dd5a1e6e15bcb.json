{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Alex Salsali\\\\Desktop\\\\Eunoia-Atlas-POC\\\\frontend\\\\src\\\\components\\\\WhisperFlow.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { xamanCreatePayment } from '../services/api';\nimport { checkUserPaymentStatus } from '../services/userWalletService';\nimport { isCrossmarkAvailable, connectCrossmark, signRlusdPaymentWithCrossmark } from '../services/crossmarkService';\nimport QRModal from './common/QRModal';\nimport { Heart, MessageSquare, Mic, ArrowLeft, ArrowRight, CheckCircle2, Eye, EyeOff } from 'lucide-react';\nimport './WhisperFlow.css';\n\n// Helpers\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DRAFT_KEY = 'whisperDraftV1';\nconst PENDING_KEY = 'whisperPendingDonationV1';\nconst QUOTES = ['\"Sometimes a few words can carry a lifetime.\"', '\"A small gift can change a whole day.\"', '\"Light grows where we speak hope.\"', '\"Your words have power beyond measure.\"', '\"Every whisper of kindness echoes forever.\"'];\nconst STORY_THEME = {\n  meda: {\n    accent: '#7c3aed',\n    soft1: '#ede9fe',\n    soft2: '#faf5ff'\n  },\n  tara: {\n    accent: '#ec4899',\n    soft1: '#ffe4f1',\n    soft2: '#fff7fb'\n  },\n  ocean: {\n    accent: '#2563eb',\n    soft1: '#dbeafe',\n    soft2: '#eff6ff'\n  }\n};\nfunction saveDraft(data) {\n  try {\n    localStorage.setItem(DRAFT_KEY, JSON.stringify(data));\n  } catch {}\n}\nfunction loadDraft() {\n  try {\n    return JSON.parse(localStorage.getItem(DRAFT_KEY) || 'null');\n  } catch {\n    return null;\n  }\n}\nfunction getPendingDonation() {\n  try {\n    return JSON.parse(localStorage.getItem(PENDING_KEY) || 'null');\n  } catch {\n    return null;\n  }\n}\nfunction clearPendingDonation() {\n  try {\n    localStorage.removeItem(PENDING_KEY);\n  } catch {}\n}\nfunction useReducedMotion() {\n  _s();\n  const [reduced, setReduced] = useState(false);\n  useEffect(() => {\n    const m = window.matchMedia('(prefers-reduced-motion: reduce)');\n    setReduced(m.matches);\n    const handler = e => setReduced(e.matches);\n    if (m.addEventListener) m.addEventListener('change', handler);else m.addListener(handler);\n    return () => {\n      if (m.removeEventListener) m.removeEventListener('change', handler);else m.removeListener(handler);\n    };\n  }, []);\n  return reduced;\n}\n_s(useReducedMotion, \"PAG4zvF6+IsK2eHB7xTPE8NJ12w=\");\nfunction vibrate(ms = 10) {\n  try {\n    if (navigator.vibrate) navigator.vibrate(ms);\n  } catch {}\n}\nconst WhisperFlow = () => {\n  _s2();\n  const [step, setStep] = useState(0);\n\n  // data\n  const [message, setMessage] = useState('');\n  const [amount, setAmount] = useState('');\n  const [otherAmount, setOtherAmount] = useState('');\n  const [isPublic, setIsPublic] = useState(false);\n  const [email, setEmail] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState(null);\n  const [showUndo, setShowUndo] = useState(false);\n  const undoTimerRef = useRef(null);\n  const [quoteIdx, setQuoteIdx] = useState(0);\n  const [showConfetti, setShowConfetti] = useState(false);\n  const [transactionUrl, setTransactionUrl] = useState(null);\n  const [xamanState, setXamanState] = useState({\n    phase: 'idle'\n  });\n  const xamanPollRef = useRef(null);\n  const [crossmarkBusy, setCrossmarkBusy] = useState(false);\n  const [crossmarkError, setCrossmarkError] = useState(null);\n  const MEDA_ADDRESS = process.env.REACT_APP_MEDA_WALLET_ADDRESS || 'rEtpfxtsuHGWbRYFGszE5etYNPaiogDpxC';\n  const reducedMotion = useReducedMotion();\n\n  // Voice\n  const [listening, setListening] = useState(false);\n  const recognitionRef = useRef(null);\n\n  // Deep link\n  const searchParams = useMemo(() => new URLSearchParams(window.location.search), []);\n  const storyId = (searchParams.get('story') || '').toLowerCase();\n  const prefillAmount = searchParams.get('amount');\n  const prefillMessage = searchParams.get('message');\n\n  // Theme\n  const theme = STORY_THEME[storyId] || STORY_THEME['meda'];\n  useEffect(() => {\n    const el = document.querySelector('.whisper');\n    if (el) {\n      el.style.setProperty('--accent', theme.accent);\n      el.style.setProperty('--soft1', theme.soft1);\n      el.style.setProperty('--soft2', theme.soft2);\n    }\n  }, [theme]);\n\n  // Quote rotation\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setQuoteIdx(prev => (prev + 1) % QUOTES.length);\n    }, 4000);\n    return () => clearInterval(interval);\n  }, []);\n\n  // Prefill from URL params\n  useEffect(() => {\n    if (prefillAmount) {\n      const num = Number(prefillAmount);\n      if (!isNaN(num) && num > 0) {\n        setAmount(num);\n        setShowUndo(true);\n        if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\n        undoTimerRef.current = window.setTimeout(() => setShowUndo(false), 3000);\n      }\n    }\n    if (prefillMessage) {\n      setMessage(prefillMessage);\n    }\n  }, [prefillAmount, prefillMessage]);\n\n  // Load draft\n  useEffect(() => {\n    const draft = loadDraft();\n    if (draft && step === 0) {\n      setMessage(draft.message || '');\n      setAmount(draft.amount || '');\n      setOtherAmount(draft.otherAmount || '');\n      setIsPublic(draft.isPublic || false);\n      setEmail(draft.email || '');\n    }\n  }, [step]);\n\n  // Save draft\n  useEffect(() => {\n    if (step > 0) {\n      saveDraft({\n        message,\n        amount,\n        otherAmount,\n        isPublic,\n        email\n      });\n    }\n  }, [message, amount, otherAmount, isPublic, email, step]);\n\n  // Check for pending donation - only restore if user explicitly continues\n  useEffect(() => {\n    const pending = getPendingDonation();\n    if (pending && pending.step === 4) {\n      // Clear pending donation to start fresh\n      clearPendingDonation();\n    }\n  }, []);\n\n  // Online status handling\n  useEffect(() => {\n    const onOnline = async () => {\n      if (step === 4) {\n        const pending = getPendingDonation();\n        if (pending) {\n          try {\n            await handleSubmit();\n            clearPendingDonation();\n          } catch (error) {\n            console.error('Failed to retry submission:', error);\n          }\n        }\n      }\n    };\n    window.addEventListener('online', onOnline);\n    return () => window.removeEventListener('online', onOnline);\n  }, [step]);\n\n  // Pointer light effect\n  useEffect(() => {\n    const el = document.querySelector('.story-hero');\n    if (!el || reducedMotion) return;\n    const onMove = e => {\n      const rect = el.getBoundingClientRect();\n      const x = (e.clientX - rect.left) / rect.width * 100;\n      const y = (e.clientY - rect.top) / rect.height * 100;\n      el.style.setProperty('--x', `${x}%`);\n      el.style.setProperty('--y', `${y}%`);\n    };\n    el.addEventListener('pointermove', onMove);\n    return () => el.removeEventListener('pointermove', onMove);\n  }, [reducedMotion]);\n  const handleMessageChange = e => {\n    setMessage(e.target.value);\n  };\n  const selectAmount = val => {\n    if (val === 'other') {\n      setAmount('other');\n      setOtherAmount('');\n    } else {\n      setAmount(val);\n      setOtherAmount('');\n    }\n    setShowUndo(true);\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\n    undoTimerRef.current = window.setTimeout(() => setShowUndo(false), 3000);\n    vibrate();\n  };\n  const undoAmount = () => {\n    setAmount('');\n    setShowUndo(false);\n  };\n  const handleOtherAmount = e => setOtherAmount(e.target.value);\n  const handleIdentityChoice = choice => {\n    setIsPublic(choice);\n    if (!choice) {\n      setEmail('');\n      setStep(4);\n    }\n    vibrate();\n  };\n  const proceedFromIdentity = () => {\n    setStep(4);\n    vibrate();\n  };\n\n  // Online status handling\n  useEffect(() => {\n    const onOnline = async () => {\n      if (step === 4) {\n        const pending = getPendingDonation();\n        if (pending) {\n          try {\n            await handleSubmit();\n            clearPendingDonation();\n          } catch (error) {\n            console.error('Failed to retry submission:', error);\n          }\n        }\n      }\n    };\n    window.addEventListener('online', onOnline);\n    return () => window.removeEventListener('online', onOnline);\n  }, [step]);\n  const handleSubmit = async () => {\n    if (submitting) return;\n    setSubmitting(true);\n    setError(null);\n    const finalAmount = amount === 'other' ? Number(otherAmount) : Number(amount);\n    if (!finalAmount || finalAmount <= 0) {\n      setError('Please enter a valid amount');\n      setSubmitting(false);\n      return;\n    }\n\n    // Use Xaman RLUSD payment flow instead of server-signed\n    await startXrpXamanFromWhisper();\n    setSubmitting(false);\n  };\n  const startXrpXamanFromWhisper = async () => {\n    if (xamanState.phase !== 'idle') return;\n    setXamanState({\n      phase: 'creating'\n    });\n    try {\n      const finalAmount = amount === 'other' ? Number(otherAmount) : Number(amount);\n      const response = await xamanCreatePayment({\n        amount: finalAmount,\n        destination: MEDA_ADDRESS,\n        charity: 'MEDA',\n        cause_id: 'whisper',\n        asset: 'RLUSD',\n        // Use RLUSD instead of XRP\n        issuer: 'rEtpfxtsuHGWbRYFGszE5etYNPaiogDpxC' // RLUSD issuer\n      });\n      if (response.success && response.payloadId) {\n        setXamanState({\n          phase: 'ready',\n          payloadId: response.payloadId,\n          qrCode: response.qrCode\n        });\n\n        // Poll for completion\n        xamanPollRef.current = window.setInterval(async () => {\n          try {\n            const status = await checkUserPaymentStatus(response.payloadId);\n            if (status.completed) {\n              if (xamanPollRef.current) clearInterval(xamanPollRef.current);\n              setXamanState({\n                phase: 'completed',\n                txid: status.txid\n              });\n              setTransactionUrl(status.transactionUrl);\n              setShowConfetti(true);\n              setTimeout(() => setShowConfetti(false), 2000);\n              setStep(5);\n            }\n          } catch (error) {\n            console.error('Payment status check failed:', error);\n          }\n        }, 2000);\n      } else {\n        setXamanState({\n          phase: 'error',\n          message: 'Failed to create payment'\n        });\n      }\n    } catch (error) {\n      console.error('Xaman payment creation failed:', error);\n      setXamanState({\n        phase: 'error',\n        message: 'Failed to create payment'\n      });\n    }\n  };\n  const startRlusdCrossmarkFromWhisper = async () => {\n    if (crossmarkBusy) return;\n    setCrossmarkBusy(true);\n    setCrossmarkError(null);\n    try {\n      if (!isCrossmarkAvailable()) {\n        throw new Error('CROSSMARK extension not found');\n      }\n      await connectCrossmark();\n      const finalAmount = amount === 'other' ? Number(otherAmount) : Number(amount);\n      const result = await signRlusdPaymentWithCrossmark({\n        amount: finalAmount,\n        destination: MEDA_ADDRESS,\n        charity: 'MEDA',\n        causeId: 'whisper'\n      });\n      if (result.ok) {\n        setTransactionUrl(result.explorer || null);\n        setShowConfetti(true);\n        setTimeout(() => setShowConfetti(false), 2000);\n        setStep(5);\n      } else {\n        setCrossmarkError(result.error || 'Payment failed');\n      }\n    } catch (error) {\n      console.error('CROSSMARK payment failed:', error);\n      setCrossmarkError(error instanceof Error ? error.message : 'Payment failed');\n    } finally {\n      setCrossmarkBusy(false);\n    }\n  };\n  const toggleMic = () => {\n    if (listening) {\n      if (recognitionRef.current) {\n        recognitionRef.current.stop();\n      }\n      setListening(false);\n    } else {\n      if ('webkitSpeechRecognition' in window) {\n        const recognition = new window.webkitSpeechRecognition();\n        recognition.continuous = false;\n        recognition.interimResults = false;\n        recognition.lang = 'en-US';\n        recognition.onstart = () => setListening(true);\n        recognition.onresult = event => {\n          const transcript = event.results[0][0].transcript;\n          setMessage(transcript);\n        };\n        recognition.onerror = () => setListening(false);\n        recognition.onend = () => setListening(false);\n        recognitionRef.current = recognition;\n        recognition.start();\n      } else {\n        alert('Speech recognition not supported in this browser');\n      }\n    }\n  };\n\n  // Confetti pieces\n  const pieces = Array.from({\n    length: 7\n  }).map((_, i) => ({\n    left: `${15 + i * 12}%`,\n    bottom: '20px',\n    background: i % 2 ? theme.accent : theme.soft1\n  }));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `whisper ${reducedMotion ? 'reduced-motion' : ''}`,\n    children: [step === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `stage full ${reducedMotion ? '' : 'fade-in'}`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"story-hero\",\n        role: \"img\",\n        \"aria-label\": storyId ? `Story ${storyId}` : 'Story image',\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overlay\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hero-content\",\n          style: {\n            textAlign: 'center',\n            width: '100%'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `hero-quote ${reducedMotion ? '' : 'quote-fade'}`,\n            style: {\n              fontSize: '2rem',\n              fontWeight: 700,\n              textAlign: 'center',\n              maxWidth: '720px',\n              lineHeight: 1.3,\n              margin: '0 auto 32px',\n              display: 'inline-block'\n            },\n            children: QUOTES[quoteIdx]\n          }, quoteIdx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 16\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"cta-button\",\n            onClick: () => {\n              setStep(1);\n              vibrate();\n            },\n            children: [/*#__PURE__*/_jsxDEV(MessageSquare, {\n              size: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 405,\n              columnNumber: 17\n            }, this), \"Whisper a Message\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 26\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 9\n    }, this), step === 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `stage center ${reducedMotion ? '' : 'fade-in'}`,\n      \"aria-live\": \"polite\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"step-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"back-button\",\n          onClick: () => {\n            setStep(0);\n            vibrate();\n          },\n          children: [/*#__PURE__*/_jsxDEV(ArrowLeft, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 15\n          }, this), \"Back\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"step-indicator\",\n          children: \"Step 1 of 4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"prompt glow type-on\",\n        children: \"I'm giving because\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"whisper-input\",\n          placeholder: \"For girls who never had a laptop.\",\n          value: message,\n          onChange: handleMessageChange,\n          autoFocus: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"input-footer\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"hint\",\n            children: listening ? 'Listening… speak your message' : 'Pause to continue'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 433,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"mic-button\",\n            onClick: toggleMic,\n            \"aria-pressed\": listening,\n            children: [/*#__PURE__*/_jsxDEV(Mic, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 17\n            }, this), listening ? 'Stop' : 'Speak']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"actions\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"primary-button\",\n          onClick: () => (message || '').trim().length > 0 ? (setStep(2), vibrate()) : null,\n          disabled: (message || '').trim().length === 0,\n          children: [\"Next\", /*#__PURE__*/_jsxDEV(ArrowRight, {\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 9\n    }, this), step === 2 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `stage center ${reducedMotion ? '' : 'fade-in'}`,\n      \"aria-live\": \"polite\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"step-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"back-button\",\n          onClick: () => {\n            setStep(1);\n            vibrate();\n          },\n          children: [/*#__PURE__*/_jsxDEV(ArrowLeft, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 458,\n            columnNumber: 15\n          }, this), \"Back\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"step-indicator\",\n          children: \"Step 2 of 4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 461,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"prompt\",\n        children: \"How much do you want to give?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"amount-grid\",\n        children: [[10, 25, 50, 100].map(v => /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `amount-pill ${amount === v ? 'selected' : ''}`,\n          onClick: () => selectAmount(v),\n          children: [\"$\", v]\n        }, v, true, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 15\n        }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `amount-pill ${amount === '' && otherAmount ? 'selected' : ''}`,\n          onClick: () => selectAmount('other'),\n          children: \"Other\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 11\n      }, this), showUndo && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"undo-hint\",\n        children: [\"Amount selected. \", /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"link-button\",\n          onClick: undoAmount,\n          children: \"Undo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 32\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 13\n      }, this), amount === '' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `other-amount-row ${reducedMotion ? '' : 'slide-up'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          inputMode: \"decimal\",\n          min: 1,\n          step: \"0.01\",\n          placeholder: \"Enter amount\",\n          className: \"other-input\",\n          value: otherAmount,\n          onChange: handleOtherAmount\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"apply-button\",\n          onClick: () => Number(otherAmount) > 0 ? (setAmount(Number(otherAmount)), setStep(3), vibrate()) : null,\n          disabled: !otherAmount || Number(otherAmount) <= 0,\n          children: \"Apply\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 494,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"actions\",\n        children: amount !== '' && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"primary-button\",\n          onClick: () => {\n            setStep(3);\n            vibrate();\n          },\n          children: [\"Next\", /*#__PURE__*/_jsxDEV(ArrowRight, {\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 504,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 455,\n      columnNumber: 9\n    }, this), step === 3 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `stage center ${reducedMotion ? '' : 'fade-in'}`,\n      \"aria-live\": \"polite\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"step-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"back-button\",\n          onClick: () => {\n            setStep(2);\n            vibrate();\n          },\n          children: [/*#__PURE__*/_jsxDEV(ArrowLeft, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 15\n          }, this), \"Back\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"step-indicator\",\n          children: \"Step 3 of 4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 517,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"prompt\",\n        children: \"Would you like the story to know who you are?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 525,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"identity-toggle\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: `toggle-button ${isPublic ? 'active' : ''}`,\n          onClick: () => handleIdentityChoice(true),\n          children: [/*#__PURE__*/_jsxDEV(Eye, {\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 528,\n            columnNumber: 15\n          }, this), \"Yes, share my name\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `toggle-button ${!isPublic ? 'active' : ''}`,\n          onClick: () => handleIdentityChoice(false),\n          children: [/*#__PURE__*/_jsxDEV(EyeOff, {\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 532,\n            columnNumber: 15\n          }, this), \"No, keep me anonymous\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 526,\n        columnNumber: 11\n      }, this), isPublic && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `email-section ${reducedMotion ? '' : 'slide-up'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          placeholder: \"you@example.com\",\n          className: \"email-input\",\n          value: email,\n          onChange: e => setEmail(e.target.value),\n          \"aria-label\": \"Email address\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 539,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"continue-button\",\n          onClick: proceedFromIdentity,\n          children: [\"Continue\", /*#__PURE__*/_jsxDEV(ArrowRight, {\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 549,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"privacy-note\",\n        children: \"We'll only use your email to send your receipt.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"actions\",\n        children: !isPublic && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"primary-button\",\n          onClick: proceedFromIdentity,\n          children: [\"Next\", /*#__PURE__*/_jsxDEV(ArrowRight, {\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 560,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 9\n    }, this), step === 4 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `stage center ${reducedMotion ? '' : 'fade-in'}`,\n      \"aria-live\": \"polite\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"step-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"back-button\",\n          onClick: () => {\n            setStep(3);\n            vibrate();\n          },\n          children: [/*#__PURE__*/_jsxDEV(ArrowLeft, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 571,\n            columnNumber: 15\n          }, this), \"Back\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 570,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"step-indicator\",\n          children: \"Step 4 of 4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 569,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        role: \"alert\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"summary-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"summary-header\",\n          children: \"Your Message\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"blockquote\", {\n          className: \"message-preview\",\n          children: [\"\\\"\", message || '', \"\\\"\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 581,\n          columnNumber: 26\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"summary-details\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"summary-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Amount:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 584,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"amount\",\n              children: [\"$\", amount === 'other' ? otherAmount : amount]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 585,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 583,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"summary-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Privacy:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 588,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: isPublic ? 'Public' : 'Anonymous'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 589,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 587,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 582,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `cta-button ${submitting ? 'disabled' : ''}`,\n        onClick: handleSubmit,\n        disabled: submitting,\n        children: submitting ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"spinner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 601,\n            columnNumber: 17\n          }, this), \"Sending\\u2026\"]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Heart, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 606,\n            columnNumber: 17\n          }, this), \"Send my words and support\"]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 594,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alternative-options\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"options-label\",\n          children: \"Or try these options:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 613,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"options-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"option-button\",\n            onClick: startXrpXamanFromWhisper,\n            children: [/*#__PURE__*/_jsxDEV(MessageSquare, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 616,\n              columnNumber: 17\n            }, this), \"XRP (Alternative)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 615,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"option-button\",\n            onClick: startRlusdCrossmarkFromWhisper,\n            disabled: crossmarkBusy,\n            children: crossmarkBusy ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"spinner\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 626,\n                columnNumber: 21\n              }, this), \"Opening\\u2026\"]\n            }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Heart, {\n                size: 16\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 631,\n                columnNumber: 21\n              }, this), \"RLUSD (CROSSMARK)\"]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 619,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 614,\n          columnNumber: 13\n        }, this), crossmarkError && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-message\",\n          role: \"alert\",\n          children: crossmarkError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 637,\n          columnNumber: 32\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 612,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 568,\n      columnNumber: 9\n    }, this), step === 5 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `stage center ${reducedMotion ? '' : 'fade-in'}`,\n      \"aria-live\": \"polite\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"success-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"success-icon\",\n          children: /*#__PURE__*/_jsxDEV(CheckCircle2, {\n            size: 48\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 646,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 645,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"success-title\",\n          children: \"Your message has been sent.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 648,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"success-subtitle\",\n          children: \"And so has your support.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 649,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"blockquote\", {\n          className: \"final-message\",\n          children: [\"\\\"\", message || '', \"\\\"\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 650,\n          columnNumber: 26\n        }, this), transactionUrl && /*#__PURE__*/_jsxDEV(\"a\", {\n          href: transactionUrl,\n          target: \"_blank\",\n          rel: \"noopener noreferrer\",\n          className: \"transaction-link\",\n          children: \"View your receipt details\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 652,\n          columnNumber: 15\n        }, this), !transactionUrl && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"processing-note\",\n          children: \"Your transaction is being processed...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 657,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"home-button\",\n          onClick: () => window.location.href = '/',\n          children: \"Return Home\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 659,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 644,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 643,\n      columnNumber: 9\n    }, this), !reducedMotion && showConfetti && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"confetti\",\n      \"aria-hidden\": true,\n      children: pieces.map((p, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"piece\",\n        style: {\n          left: p.left,\n          bottom: p.bottom,\n          background: p.background\n        }\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 669,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 667,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(QRModal, {\n      open: xamanState.phase === 'creating' || xamanState.phase === 'ready',\n      title: \"Donate with RLUSD\",\n      qrUrl: xamanState.phase === 'ready' ? xamanState.qrCode : undefined,\n      openLink: xamanState.phase === 'ready' ? `https://xumm.app/sign/${xamanState.payloadId}` : undefined,\n      network: \"Testnet\",\n      status: xamanState.phase === 'creating' ? 'Creating RLUSD payment…' : xamanState.phase === 'ready' ? 'Scan to sign in Xaman' : undefined,\n      onClose: () => setXamanState({\n        phase: 'idle'\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 674,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 381,\n    columnNumber: 5\n  }, this);\n};\n_s2(WhisperFlow, \"ddVFnxymQzqqQQ4FIeOsIMvY2xc=\", false, function () {\n  return [useReducedMotion];\n});\n_c = WhisperFlow;\nexport default WhisperFlow;\nvar _c;\n$RefreshReg$(_c, \"WhisperFlow\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","xamanCreatePayment","checkUserPaymentStatus","isCrossmarkAvailable","connectCrossmark","signRlusdPaymentWithCrossmark","QRModal","Heart","MessageSquare","Mic","ArrowLeft","ArrowRight","CheckCircle2","Eye","EyeOff","jsxDEV","_jsxDEV","Fragment","_Fragment","DRAFT_KEY","PENDING_KEY","QUOTES","STORY_THEME","meda","accent","soft1","soft2","tara","ocean","saveDraft","data","localStorage","setItem","JSON","stringify","loadDraft","parse","getItem","getPendingDonation","clearPendingDonation","removeItem","useReducedMotion","_s","reduced","setReduced","m","window","matchMedia","matches","handler","e","addEventListener","addListener","removeEventListener","removeListener","vibrate","ms","navigator","WhisperFlow","_s2","step","setStep","message","setMessage","amount","setAmount","otherAmount","setOtherAmount","isPublic","setIsPublic","email","setEmail","submitting","setSubmitting","error","setError","showUndo","setShowUndo","undoTimerRef","quoteIdx","setQuoteIdx","showConfetti","setShowConfetti","transactionUrl","setTransactionUrl","xamanState","setXamanState","phase","xamanPollRef","crossmarkBusy","setCrossmarkBusy","crossmarkError","setCrossmarkError","MEDA_ADDRESS","process","env","REACT_APP_MEDA_WALLET_ADDRESS","reducedMotion","listening","setListening","recognitionRef","searchParams","URLSearchParams","location","search","storyId","get","toLowerCase","prefillAmount","prefillMessage","theme","el","document","querySelector","style","setProperty","interval","setInterval","prev","length","clearInterval","num","Number","isNaN","current","clearTimeout","setTimeout","draft","pending","onOnline","handleSubmit","console","onMove","rect","getBoundingClientRect","x","clientX","left","width","y","clientY","top","height","handleMessageChange","target","value","selectAmount","val","undoAmount","handleOtherAmount","handleIdentityChoice","choice","proceedFromIdentity","finalAmount","startXrpXamanFromWhisper","response","destination","charity","cause_id","asset","issuer","success","payloadId","qrCode","status","completed","txid","startRlusdCrossmarkFromWhisper","Error","result","causeId","ok","explorer","toggleMic","stop","recognition","webkitSpeechRecognition","continuous","interimResults","lang","onstart","onresult","event","transcript","results","onerror","onend","start","alert","pieces","Array","from","map","_","i","bottom","background","className","children","role","fileName","_jsxFileName","lineNumber","columnNumber","textAlign","fontSize","fontWeight","maxWidth","lineHeight","margin","display","onClick","size","placeholder","onChange","autoFocus","trim","disabled","v","type","inputMode","min","href","rel","p","open","title","qrUrl","undefined","openLink","network","onClose","_c","$RefreshReg$"],"sources":["C:/Users/Alex Salsali/Desktop/Eunoia-Atlas-POC/frontend/src/components/WhisperFlow.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { xamanCreatePayment } from '../services/api';\nimport { checkUserPaymentStatus } from '../services/userWalletService';\nimport { isCrossmarkAvailable, connectCrossmark, signRlusdPaymentWithCrossmark } from '../services/crossmarkService';\nimport QRModal from './common/QRModal';\nimport { Heart, MessageSquare, Mic, ArrowLeft, ArrowRight, CheckCircle2, Eye, EyeOff } from 'lucide-react';\nimport './WhisperFlow.css';\n\n// Helpers\nconst DRAFT_KEY = 'whisperDraftV1';\nconst PENDING_KEY = 'whisperPendingDonationV1';\nconst QUOTES = [\n  '\"Sometimes a few words can carry a lifetime.\"',\n  '\"A small gift can change a whole day.\"',\n  '\"Light grows where we speak hope.\"',\n  '\"Your words have power beyond measure.\"',\n  '\"Every whisper of kindness echoes forever.\"',\n];\n\nconst STORY_THEME: Record<string, { accent: string; soft1: string; soft2: string }> = {\n  meda: { accent: '#7c3aed', soft1: '#ede9fe', soft2: '#faf5ff' },\n  tara: { accent: '#ec4899', soft1: '#ffe4f1', soft2: '#fff7fb' },\n  ocean: { accent: '#2563eb', soft1: '#dbeafe', soft2: '#eff6ff' },\n};\n\nfunction saveDraft(data: any) { try { localStorage.setItem(DRAFT_KEY, JSON.stringify(data)); } catch {} }\nfunction loadDraft(): any | null { try { return JSON.parse(localStorage.getItem(DRAFT_KEY) || 'null'); } catch { return null; } }\n\nfunction getPendingDonation(): any | null { try { return JSON.parse(localStorage.getItem(PENDING_KEY) || 'null'); } catch { return null; } }\nfunction clearPendingDonation() { try { localStorage.removeItem(PENDING_KEY); } catch {} }\n\nfunction useReducedMotion() {\n  const [reduced, setReduced] = useState(false);\n  useEffect(() => {\n    const m = window.matchMedia('(prefers-reduced-motion: reduce)');\n    setReduced(m.matches);\n    const handler = (e: MediaQueryListEvent) => setReduced(e.matches);\n    if (m.addEventListener) m.addEventListener('change', handler);\n    else m.addListener(handler as any);\n    return () => {\n      if (m.removeEventListener) m.removeEventListener('change', handler);\n      else m.removeListener(handler as any);\n    };\n  }, []);\n  return reduced;\n}\n\nfunction vibrate(ms = 10) { try { if (navigator.vibrate) navigator.vibrate(ms); } catch {} }\n\nconst WhisperFlow: React.FC = () => {\n  const [step, setStep] = useState<number>(0);\n\n  // data\n  const [message, setMessage] = useState('');\n  const [amount, setAmount] = useState<number | 'other' | ''>('');\n  const [otherAmount, setOtherAmount] = useState<string>('');\n  const [isPublic, setIsPublic] = useState<boolean>(false);\n  const [email, setEmail] = useState<string>('');\n\n\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const [showUndo, setShowUndo] = useState<boolean>(false);\n  const undoTimerRef = useRef<number | null>(null);\n  const [quoteIdx, setQuoteIdx] = useState(0);\n  const [showConfetti, setShowConfetti] = useState(false);\n  const [transactionUrl, setTransactionUrl] = useState<string | null>(null);\n  const [xamanState, setXamanState] = useState<\n    | { phase: 'idle' }\n    | { phase: 'creating' }\n    | { phase: 'ready'; payloadId: string; qrCode?: string; message?: string }\n    | { phase: 'completed'; txid?: string }\n    | { phase: 'error'; message: string }\n  >({ phase: 'idle' });\n  const xamanPollRef = useRef<number | null>(null);\n  const [crossmarkBusy, setCrossmarkBusy] = useState(false);\n  const [crossmarkError, setCrossmarkError] = useState<string | null>(null);\n\n  const MEDA_ADDRESS = (process.env.REACT_APP_MEDA_WALLET_ADDRESS as string) || 'rEtpfxtsuHGWbRYFGszE5etYNPaiogDpxC';\n\n  const reducedMotion = useReducedMotion();\n\n  // Voice\n  const [listening, setListening] = useState(false);\n  const recognitionRef = useRef<any>(null);\n\n  // Deep link\n  const searchParams = useMemo(() => new URLSearchParams(window.location.search), []);\n  const storyId = (searchParams.get('story') || '').toLowerCase();\n  const prefillAmount = searchParams.get('amount');\n  const prefillMessage = searchParams.get('message');\n\n  // Theme\n  const theme = STORY_THEME[storyId] || STORY_THEME['meda'];\n\n  useEffect(() => {\n    const el = document.querySelector('.whisper') as HTMLElement | null;\n    if (el) {\n      el.style.setProperty('--accent', theme.accent);\n      el.style.setProperty('--soft1', theme.soft1);\n      el.style.setProperty('--soft2', theme.soft2);\n    }\n  }, [theme]);\n\n  // Quote rotation\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setQuoteIdx((prev) => (prev + 1) % QUOTES.length);\n    }, 4000);\n    return () => clearInterval(interval);\n  }, []);\n\n  // Prefill from URL params\n  useEffect(() => {\n    if (prefillAmount) {\n      const num = Number(prefillAmount);\n      if (!isNaN(num) && num > 0) {\n        setAmount(num);\n        setShowUndo(true);\n        if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\n        undoTimerRef.current = window.setTimeout(() => setShowUndo(false), 3000);\n      }\n    }\n    if (prefillMessage) {\n      setMessage(prefillMessage);\n    }\n  }, [prefillAmount, prefillMessage]);\n\n  // Load draft\n  useEffect(() => {\n    const draft = loadDraft();\n    if (draft && step === 0) {\n      setMessage(draft.message || '');\n      setAmount(draft.amount || '');\n      setOtherAmount(draft.otherAmount || '');\n      setIsPublic(draft.isPublic || false);\n      setEmail(draft.email || '');\n    }\n  }, [step]);\n\n  // Save draft\n  useEffect(() => {\n    if (step > 0) {\n      saveDraft({ message, amount, otherAmount, isPublic, email });\n    }\n  }, [message, amount, otherAmount, isPublic, email, step]);\n\n  // Check for pending donation - only restore if user explicitly continues\n  useEffect(() => {\n    const pending = getPendingDonation();\n    if (pending && pending.step === 4) {\n      // Clear pending donation to start fresh\n      clearPendingDonation();\n    }\n  }, []);\n\n  // Online status handling\n  useEffect(() => {\n    const onOnline = async () => {\n      if (step === 4) {\n        const pending = getPendingDonation();\n        if (pending) {\n          try {\n            await handleSubmit();\n            clearPendingDonation();\n          } catch (error) {\n            console.error('Failed to retry submission:', error);\n          }\n        }\n      }\n    };\n\n    window.addEventListener('online', onOnline);\n    return () => window.removeEventListener('online', onOnline);\n  }, [step]);\n\n  // Pointer light effect\n  useEffect(() => {\n    const el = document.querySelector('.story-hero') as HTMLElement | null;\n    if (!el || reducedMotion) return;\n\n    const onMove = (e: PointerEvent) => {\n      const rect = el.getBoundingClientRect();\n      const x = ((e.clientX - rect.left) / rect.width) * 100;\n      const y = ((e.clientY - rect.top) / rect.height) * 100;\n      el.style.setProperty('--x', `${x}%`);\n      el.style.setProperty('--y', `${y}%`);\n    };\n\n    el.addEventListener('pointermove', onMove);\n    return () => el.removeEventListener('pointermove', onMove);\n  }, [reducedMotion]);\n\n  const handleMessageChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setMessage(e.target.value);\n  };\n\n\n\n  const selectAmount = (val: number | 'other') => {\n    if (val === 'other') {\n      setAmount('other');\n      setOtherAmount('');\n    } else {\n      setAmount(val);\n      setOtherAmount('');\n    }\n    setShowUndo(true);\n    if (undoTimerRef.current) clearTimeout(undoTimerRef.current);\n    undoTimerRef.current = window.setTimeout(() => setShowUndo(false), 3000);\n    vibrate();\n  };\n\n  const undoAmount = () => { setAmount(''); setShowUndo(false); };\n  const handleOtherAmount = (e: React.ChangeEvent<HTMLInputElement>) => setOtherAmount(e.target.value);\n  const handleIdentityChoice = (choice: boolean) => { setIsPublic(choice); if (!choice) { setEmail(''); setStep(4); } vibrate(); };\n  const proceedFromIdentity = () => { setStep(4); vibrate(); };\n\n  // Online status handling\n  useEffect(() => {\n    const onOnline = async () => {\n      if (step === 4) {\n        const pending = getPendingDonation();\n        if (pending) {\n          try {\n            await handleSubmit();\n            clearPendingDonation();\n          } catch (error) {\n            console.error('Failed to retry submission:', error);\n          }\n        }\n      }\n    };\n\n    window.addEventListener('online', onOnline);\n    return () => window.removeEventListener('online', onOnline);\n  }, [step]);\n\n  const handleSubmit = async () => {\n    if (submitting) return;\n    \n    setSubmitting(true);\n    setError(null);\n    \n    const finalAmount = amount === 'other' ? Number(otherAmount) : Number(amount);\n    \n    if (!finalAmount || finalAmount <= 0) {\n      setError('Please enter a valid amount');\n      setSubmitting(false);\n      return;\n    }\n\n    // Use Xaman RLUSD payment flow instead of server-signed\n    await startXrpXamanFromWhisper();\n    setSubmitting(false);\n  };\n\n  const startXrpXamanFromWhisper = async () => {\n    if (xamanState.phase !== 'idle') return;\n    \n    setXamanState({ phase: 'creating' });\n    \n    try {\n      const finalAmount = amount === 'other' ? Number(otherAmount) : Number(amount);\n      const response = await xamanCreatePayment({\n        amount: finalAmount,\n        destination: MEDA_ADDRESS,\n        charity: 'MEDA',\n        cause_id: 'whisper',\n        asset: 'RLUSD', // Use RLUSD instead of XRP\n        issuer: 'rEtpfxtsuHGWbRYFGszE5etYNPaiogDpxC' // RLUSD issuer\n      });\n      \n      if (response.success && response.payloadId) {\n        setXamanState({ \n          phase: 'ready', \n          payloadId: response.payloadId,\n          qrCode: response.qrCode\n        });\n        \n        // Poll for completion\n        xamanPollRef.current = window.setInterval(async () => {\n          try {\n            const status = await checkUserPaymentStatus(response.payloadId!);\n            if (status.completed) {\n              if (xamanPollRef.current) clearInterval(xamanPollRef.current);\n              setXamanState({ phase: 'completed', txid: status.txid });\n              setTransactionUrl(status.transactionUrl);\n              setShowConfetti(true);\n              setTimeout(() => setShowConfetti(false), 2000);\n              setStep(5);\n            }\n          } catch (error) {\n            console.error('Payment status check failed:', error);\n          }\n        }, 2000);\n      } else {\n        setXamanState({ phase: 'error', message: 'Failed to create payment' });\n      }\n    } catch (error) {\n      console.error('Xaman payment creation failed:', error);\n      setXamanState({ phase: 'error', message: 'Failed to create payment' });\n    }\n  };\n\n  const startRlusdCrossmarkFromWhisper = async () => {\n    if (crossmarkBusy) return;\n    \n    setCrossmarkBusy(true);\n    setCrossmarkError(null);\n    \n    try {\n      if (!isCrossmarkAvailable()) {\n        throw new Error('CROSSMARK extension not found');\n      }\n      \n      await connectCrossmark();\n      const finalAmount = amount === 'other' ? Number(otherAmount) : Number(amount);\n      \n      const result = await signRlusdPaymentWithCrossmark({\n        amount: finalAmount,\n        destination: MEDA_ADDRESS,\n        charity: 'MEDA',\n        causeId: 'whisper'\n      });\n      \n      if (result.ok) {\n        setTransactionUrl(result.explorer || null);\n        setShowConfetti(true);\n        setTimeout(() => setShowConfetti(false), 2000);\n        setStep(5);\n      } else {\n        setCrossmarkError(result.error || 'Payment failed');\n      }\n    } catch (error) {\n      console.error('CROSSMARK payment failed:', error);\n      setCrossmarkError(error instanceof Error ? error.message : 'Payment failed');\n    } finally {\n      setCrossmarkBusy(false);\n    }\n  };\n\n  const toggleMic = () => {\n    if (listening) {\n      if (recognitionRef.current) {\n        recognitionRef.current.stop();\n      }\n      setListening(false);\n    } else {\n      if ('webkitSpeechRecognition' in window) {\n        const recognition = new (window as any).webkitSpeechRecognition();\n        recognition.continuous = false;\n        recognition.interimResults = false;\n        recognition.lang = 'en-US';\n        \n        recognition.onstart = () => setListening(true);\n        recognition.onresult = (event: any) => {\n          const transcript = event.results[0][0].transcript;\n          setMessage(transcript);\n        };\n        recognition.onerror = () => setListening(false);\n        recognition.onend = () => setListening(false);\n        \n        recognitionRef.current = recognition;\n        recognition.start();\n      } else {\n        alert('Speech recognition not supported in this browser');\n      }\n    }\n  };\n\n  // Confetti pieces\n  const pieces = Array.from({ length: 7 }).map((_, i) => ({\n    left: `${15 + i * 12}%`,\n    bottom: '20px',\n    background: i % 2 ? theme.accent : theme.soft1,\n  }));\n\n  return (\n    <div className={`whisper ${reducedMotion ? 'reduced-motion' : ''}`}>\n      \n\n      {step === 0 && (\n        <div className={`stage full ${reducedMotion ? '' : 'fade-in'}`}>\n          <div className=\"story-hero\" role=\"img\" aria-label={storyId ? `Story ${storyId}` : 'Story image'}>\n            <div className=\"overlay\" />\n                         <div className=\"hero-content\" style={{ textAlign: 'center', width: '100%' }}>\n               <div \n                 key={quoteIdx} \n                 className={`hero-quote ${reducedMotion ? '' : 'quote-fade'}`}\n                 style={{\n                   fontSize: '2rem',\n                   fontWeight: 700,\n                   textAlign: 'center',\n                   maxWidth: '720px',\n                   lineHeight: 1.3,\n                   margin: '0 auto 32px',\n                   display: 'inline-block'\n                 }}\n               >\n                 {QUOTES[quoteIdx]}\n               </div>\n              <button className=\"cta-button\" onClick={() => { setStep(1); vibrate(); }}>\n                <MessageSquare size={20} />\n                Whisper a Message\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {step === 1 && (\n        <div className={`stage center ${reducedMotion ? '' : 'fade-in'}`} aria-live=\"polite\">\n          <div className=\"step-header\">\n            <button className=\"back-button\" onClick={() => { setStep(0); vibrate(); }}>\n              <ArrowLeft size={20} />\n              Back\n            </button>\n            <div className=\"step-indicator\">Step 1 of 4</div>\n          </div>\n          \n          <div className=\"prompt glow type-on\">I'm giving because…</div>\n          <div className=\"input-container\">\n            <textarea \n              className=\"whisper-input\" \n              placeholder=\"For girls who never had a laptop.\" \n              value={message} \n              onChange={handleMessageChange} \n              autoFocus \n            />\n            <div className=\"input-footer\">\n              <div className=\"hint\">{listening ? 'Listening… speak your message' : 'Pause to continue'}</div>\n              <button className=\"mic-button\" onClick={toggleMic} aria-pressed={listening}>\n                <Mic size={16} />\n                {listening ? 'Stop' : 'Speak'}\n              </button>\n            </div>\n          </div>\n          \n          <div className=\"actions\">\n            <button \n              className=\"primary-button\" \n              onClick={() => ((message || '').trim().length > 0 ? (setStep(2), vibrate()) : null)} \n              disabled={(message || '').trim().length === 0}\n            >\n              Next\n              <ArrowRight size={16} />\n            </button>\n          </div>\n        </div>\n      )}\n\n      {step === 2 && (\n        <div className={`stage center ${reducedMotion ? '' : 'fade-in'}`} aria-live=\"polite\">\n          <div className=\"step-header\">\n            <button className=\"back-button\" onClick={() => { setStep(1); vibrate(); }}>\n              <ArrowLeft size={20} />\n              Back\n            </button>\n            <div className=\"step-indicator\">Step 2 of 4</div>\n          </div>\n          \n          <div className=\"prompt\">How much do you want to give?</div>\n          <div className=\"amount-grid\">\n            {[10, 25, 50, 100].map((v) => (\n              <button key={v} className={`amount-pill ${amount === v ? 'selected' : ''}`} onClick={() => selectAmount(v)}>\n                ${v}\n              </button>\n            ))}\n            <button className={`amount-pill ${amount === '' && otherAmount ? 'selected' : ''}`} onClick={() => selectAmount('other')}>\n              Other\n            </button>\n          </div>\n\n          {showUndo && (\n            <div className=\"undo-hint\">\n              Amount selected. <button className=\"link-button\" onClick={undoAmount}>Undo</button>\n            </div>\n          )}\n\n          {amount === '' && (\n            <div className={`other-amount-row ${reducedMotion ? '' : 'slide-up'}`}>\n              <input \n                type=\"number\" \n                inputMode=\"decimal\" \n                min={1} \n                step=\"0.01\" \n                placeholder=\"Enter amount\" \n                className=\"other-input\" \n                value={otherAmount} \n                onChange={handleOtherAmount} \n              />\n              <button \n                className=\"apply-button\" \n                onClick={() => (Number(otherAmount) > 0 ? (setAmount(Number(otherAmount)), setStep(3), vibrate()) : null)} \n                disabled={!otherAmount || Number(otherAmount) <= 0}\n              >\n                Apply\n              </button>\n            </div>\n          )}\n\n          <div className=\"actions\">\n            {amount !== '' && (\n              <button className=\"primary-button\" onClick={() => { setStep(3); vibrate(); }}>\n                Next\n                <ArrowRight size={16} />\n              </button>\n            )}\n          </div>\n        </div>\n      )}\n\n      {step === 3 && (\n        <div className={`stage center ${reducedMotion ? '' : 'fade-in'}`} aria-live=\"polite\">\n          <div className=\"step-header\">\n            <button className=\"back-button\" onClick={() => { setStep(2); vibrate(); }}>\n              <ArrowLeft size={20} />\n              Back\n            </button>\n            <div className=\"step-indicator\">Step 3 of 4</div>\n          </div>\n          \n          <div className=\"prompt\">Would you like the story to know who you are?</div>\n          <div className=\"identity-toggle\">\n            <button className={`toggle-button ${isPublic ? 'active' : ''}`} onClick={() => handleIdentityChoice(true)}>\n              <Eye size={16} />\n              Yes, share my name\n            </button>\n            <button className={`toggle-button ${!isPublic ? 'active' : ''}`} onClick={() => handleIdentityChoice(false)}>\n              <EyeOff size={16} />\n              No, keep me anonymous\n            </button>\n          </div>\n\n          {isPublic && (\n            <div className={`email-section ${reducedMotion ? '' : 'slide-up'}`}>\n              <input \n                type=\"email\" \n                placeholder=\"you@example.com\" \n                className=\"email-input\" \n                value={email} \n                onChange={(e) => setEmail(e.target.value)} \n                aria-label=\"Email address\" \n              />\n              <button className=\"continue-button\" onClick={proceedFromIdentity}>\n                Continue\n                <ArrowRight size={16} />\n              </button>\n            </div>\n          )}\n\n          <div className=\"privacy-note\">We'll only use your email to send your receipt.</div>\n\n          <div className=\"actions\">\n            {!isPublic && (\n              <button className=\"primary-button\" onClick={proceedFromIdentity}>\n                Next\n                <ArrowRight size={16} />\n              </button>\n            )}\n          </div>\n        </div>\n      )}\n\n      {step === 4 && (\n        <div className={`stage center ${reducedMotion ? '' : 'fade-in'}`} aria-live=\"polite\">\n          <div className=\"step-header\">\n            <button className=\"back-button\" onClick={() => { setStep(3); vibrate(); }}>\n              <ArrowLeft size={20} />\n              Back\n            </button>\n            <div className=\"step-indicator\">Step 4 of 4</div>\n          </div>\n          \n          {error && <div className=\"error-message\" role=\"alert\">{error}</div>}\n          \n          <div className=\"summary-card\">\n            <div className=\"summary-header\">Your Message</div>\n                         <blockquote className=\"message-preview\">\"{message || ''}\"</blockquote>\n            <div className=\"summary-details\">\n              <div className=\"summary-item\">\n                <span>Amount:</span>\n                <span className=\"amount\">${amount === 'other' ? otherAmount : amount}</span>\n              </div>\n              <div className=\"summary-item\">\n                <span>Privacy:</span>\n                <span>{isPublic ? 'Public' : 'Anonymous'}</span>\n              </div>\n            </div>\n          </div>\n          \n          <button \n            className={`cta-button ${submitting ? 'disabled' : ''}`} \n            onClick={handleSubmit} \n            disabled={submitting}\n          >\n            {submitting ? (\n              <>\n                <div className=\"spinner\" />\n                Sending…\n              </>\n            ) : (\n              <>\n                <Heart size={20} />\n                Send my words and support\n              </>\n            )}\n          </button>\n          \n          <div className=\"alternative-options\">\n            <div className=\"options-label\">Or try these options:</div>\n            <div className=\"options-grid\">\n              <button className=\"option-button\" onClick={startXrpXamanFromWhisper}>\n                <MessageSquare size={16} />\n                XRP (Alternative)\n              </button>\n              <button \n                className=\"option-button\" \n                onClick={startRlusdCrossmarkFromWhisper} \n                disabled={crossmarkBusy}\n              >\n                {crossmarkBusy ? (\n                  <>\n                    <div className=\"spinner\" />\n                    Opening…\n                  </>\n                ) : (\n                  <>\n                    <Heart size={16} />\n                    RLUSD (CROSSMARK)\n                  </>\n                )}\n              </button>\n            </div>\n            {crossmarkError && <div className=\"error-message\" role=\"alert\">{crossmarkError}</div>}\n          </div>\n        </div>\n      )}\n\n      {step === 5 && (\n        <div className={`stage center ${reducedMotion ? '' : 'fade-in'}`} aria-live=\"polite\">\n          <div className=\"success-card\">\n            <div className=\"success-icon\">\n              <CheckCircle2 size={48} />\n            </div>\n            <h1 className=\"success-title\">Your message has been sent.</h1>\n            <p className=\"success-subtitle\">And so has your support.</p>\n                         <blockquote className=\"final-message\">\"{message || ''}\"</blockquote>\n            {transactionUrl && (\n              <a href={transactionUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"transaction-link\">\n                View your receipt details\n              </a>\n            )}\n            {!transactionUrl && (\n              <p className=\"processing-note\">Your transaction is being processed...</p>\n            )}\n            <button className=\"home-button\" onClick={() => window.location.href = '/'}>\n              Return Home\n            </button>\n          </div>\n        </div>\n      )}\n\n      {!reducedMotion && showConfetti && (\n        <div className=\"confetti\" aria-hidden>\n          {pieces.map((p, i) => (\n            <div key={i} className=\"piece\" style={{ left: p.left, bottom: p.bottom, background: p.background }} />\n          ))}\n        </div>\n      )}\n\n      <QRModal\n        open={xamanState.phase === 'creating' || xamanState.phase === 'ready'}\n        title=\"Donate with RLUSD\"\n        qrUrl={xamanState.phase === 'ready' ? xamanState.qrCode : undefined}\n        openLink={xamanState.phase === 'ready' ? `https://xumm.app/sign/${(xamanState as any).payloadId}` : undefined}\n        network=\"Testnet\"\n        status={xamanState.phase === 'creating' ? 'Creating RLUSD payment…' : xamanState.phase === 'ready' ? 'Scan to sign in Xaman' : undefined}\n        onClose={() => setXamanState({ phase: 'idle' })}\n      />\n    </div>\n  );\n};\n\nexport default WhisperFlow;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
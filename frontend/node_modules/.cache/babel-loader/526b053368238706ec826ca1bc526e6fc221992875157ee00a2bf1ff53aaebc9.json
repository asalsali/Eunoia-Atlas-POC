{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Payload = void 0;\nconst debug_1 = require(\"debug\");\nconst websocket_1 = require(\"websocket\");\nconst utils_1 = require(\"./utils\");\nconst log = debug_1.debug('xumm-sdk:payload');\nconst logWs = debug_1.debug('xumm-sdk:payload:websocket');\nconst maxSocketConnectAttempts = typeof jest !== 'undefined' ? 0 : 30;\nconst socketConnectAttemptSecondsDelay = 2;\nconst socketKeepaliveSendSeconds = 2;\nconst socketKeepaliveTimeoutSeconds = 10;\nclass Payload {\n  constructor(MetaObject) {\n    log('Constructed');\n    this.Meta = MetaObject;\n  }\n  resolvePayload(payload) {\n    var _a, _b, _c;\n    return __awaiter(this, void 0, void 0, function* () {\n      if (typeof payload === 'string') {\n        return yield this.get(payload, true);\n      } else if (typeof ((_a = payload) === null || _a === void 0 ? void 0 : _a.uuid) !== 'undefined') {\n        return yield this.get(payload.uuid, true);\n      } else if (typeof ((_c = (_b = payload) === null || _b === void 0 ? void 0 : _b.meta) === null || _c === void 0 ? void 0 : _c.uuid) !== 'undefined') {\n        return payload;\n      }\n      throw new Error('Could not resolve payload (not found)');\n    });\n  }\n  create(payload, returnErrors = false) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function* () {\n      const directTx = typeof payload.TransactionType !== 'undefined' && typeof payload.txjson === 'undefined';\n      const call = yield this.Meta.call('payload', 'POST', directTx ? {\n        txjson: payload\n      } : payload);\n      if (returnErrors) {\n        utils_1.throwIfError(call);\n      }\n      const isCreatedPayload = ((_a = call) === null || _a === void 0 ? void 0 : _a.next) !== undefined;\n      if (!isCreatedPayload) {\n        return null;\n      }\n      return call;\n    });\n  }\n  get(payload, returnErrors = false) {\n    var _a, _b;\n    return __awaiter(this, void 0, void 0, function* () {\n      const payloadUuid = typeof payload === 'string' ? payload : payload === null || payload === void 0 ? void 0 : payload.uuid;\n      const call = yield this.Meta.call('payload/' + payloadUuid, 'GET');\n      if (returnErrors) {\n        utils_1.throwIfError(call);\n      }\n      const isPayload = ((_b = (_a = call) === null || _a === void 0 ? void 0 : _a.meta) === null || _b === void 0 ? void 0 : _b.uuid) !== undefined;\n      if (!isPayload) {\n        return null;\n      }\n      return call;\n    });\n  }\n  subscribe(payload, callback) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const callbackPromise = new utils_1.DeferredPromise();\n      const payloadDetails = yield this.resolvePayload(payload);\n      if (payloadDetails) {\n        const _u = 'undefined'; // For Jest tests\n        let socket;\n        let keepAlivePing;\n        let keepAliveReinstateTimer;\n        let reconnectAttempts = 0;\n        callbackPromise.promise.then(() => {\n          clearTimeout(keepAlivePing);\n          clearTimeout(keepAliveReinstateTimer);\n          socket.close(1000);\n        });\n        const connect = () => {\n          var _a, _b;\n          socket = typeof ((_a = globalThis) === null || _a === void 0 ? void 0 : _a.MockedWebSocket) !== _u && typeof jest !== _u ? new ((_b = globalThis) === null || _b === void 0 ? void 0 : _b.MockedWebSocket)('ws://xumm.local') : new websocket_1.w3cwebsocket(this.Meta.endpoint.replace(/^http/, 'ws') + '/sign/' + payloadDetails.meta.uuid);\n          socket.onopen = () => {\n            console.log(`Payload ${payloadDetails.meta.uuid}: subscription active (WebSocket opened)`);\n            keepAlivePing = setInterval(() => {\n              logWs('Send keepalive');\n              socket.send('{\"ping\":true}');\n            }, socketKeepaliveSendSeconds * 1000);\n          };\n          socket.onmessage = MessageEvent => __awaiter(this, void 0, void 0, function* () {\n            reconnectAttempts = 0;\n            const m = MessageEvent.data;\n            let json = undefined;\n            try {\n              json = JSON.parse(m.toString());\n              if ((json === null || json === void 0 ? void 0 : json.message) && json.message === 'Right back at you!') {\n                // Keepalive responses\n                logWs('Keepalive response');\n                clearTimeout(keepAliveReinstateTimer);\n                keepAliveReinstateTimer = setTimeout(() => {\n                  console.log(`WebSocket for ${payloadDetails.meta.uuid} ` + `keepalive response timeout, assume dead... (Reconnect)`);\n                  socket.close(1002, 'Assume dead');\n                }, socketKeepaliveTimeoutSeconds * 1000);\n                return;\n              }\n              if ((json === null || json === void 0 ? void 0 : json.signed) || (json === null || json === void 0 ? void 0 : json.expired)) {\n                // The payload has been signed or expired, update the referenced payload\n                const updatedPayloadDetails = yield this.resolvePayload(payload);\n                Object.assign(payloadDetails, Object.assign({}, updatedPayloadDetails));\n              }\n            } catch (e) {\n              // Do nothing\n              logWs(`Payload ${payloadDetails.meta.uuid}: Received message, unable to parse as JSON`, e);\n            }\n            if (json && callback && typeof json.devapp_fetched === 'undefined') {\n              try {\n                // log(`Payload ${payload}`, json)\n                const callbackResult = yield callback({\n                  uuid: payloadDetails.meta.uuid,\n                  data: json,\n                  resolve(resolveData) {\n                    return __awaiter(this, void 0, void 0, function* () {\n                      yield callbackPromise.resolve(resolveData || undefined);\n                    });\n                  },\n                  payload: payloadDetails\n                });\n                if (callbackResult !== undefined) {\n                  callbackPromise.resolve(callbackResult);\n                }\n              } catch (e) {\n                // Do nothing\n                logWs(`Payload ${payloadDetails.meta.uuid}: Callback exception`, e);\n                // This one emit for devs to know about this problem\n                console.log(`Payload ${payloadDetails.meta.uuid}: Callback exception: ${e.message}`);\n              }\n            }\n          });\n          socket.onclose = _e => {\n            logWs('Closed [code]', _e.code);\n            logWs('Closed [reason]', _e.reason);\n            logWs('Closed [wasClean]', _e.wasClean);\n            clearInterval(keepAlivePing);\n            clearTimeout(keepAliveReinstateTimer);\n            // Reconnect\n            if (_e.code > 1000 || _e.wasClean === false) {\n              console.log(_e);\n              logWs('Unhealthy disconnect, reconnecting...', _e.code);\n              if (reconnectAttempts < maxSocketConnectAttempts) {\n                if (reconnectAttempts === 0) {\n                  console.log(`WebSocket for ${payloadDetails.meta.uuid} lost, reconnecting...`);\n                }\n                setTimeout(() => {\n                  reconnectAttempts++;\n                  logWs('# Reconnect');\n                  if (typeof jest === 'undefined') {\n                    socket = connect();\n                  }\n                }, socketConnectAttemptSecondsDelay * 1000);\n              } else {\n                if (typeof jest === 'undefined') {\n                  console.log(`WebSocket for ${payloadDetails.meta.uuid} exceeded reconnect timeouts, give up`);\n                }\n              }\n            } else {\n              // Socket closed on purpose (?)\n            }\n            logWs(`Payload ${payloadDetails.meta.uuid}: Subscription ended (WebSocket closed)`);\n          };\n          return socket;\n        };\n        socket = connect();\n        return {\n          payload: payloadDetails,\n          resolve(resolveData) {\n            callbackPromise.resolve(resolveData || undefined);\n          },\n          resolved: callbackPromise.promise,\n          websocket: socket\n        };\n      }\n      utils_1.throwIfError(payloadDetails);\n      throw Error(`Couldn't subscribe: couldn't fetch payload`);\n    });\n  }\n  cancel(payload, returnErrors = false) {\n    var _a, _b, _c;\n    return __awaiter(this, void 0, void 0, function* () {\n      const fullPayload = yield this.resolvePayload(payload);\n      const call = yield this.Meta.call('payload/' + ((_a = fullPayload === null || fullPayload === void 0 ? void 0 : fullPayload.meta) === null || _a === void 0 ? void 0 : _a.uuid), 'DELETE');\n      if (returnErrors) {\n        utils_1.throwIfError(call);\n      }\n      const isValidResponse = ((_c = (_b = call) === null || _b === void 0 ? void 0 : _b.meta) === null || _c === void 0 ? void 0 : _c.uuid) !== undefined;\n      if (!isValidResponse) {\n        return null;\n      }\n      return call;\n    });\n  }\n  createAndSubscribe(payload, callback) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const createdPayload = yield this.create(payload, true);\n      if (createdPayload) {\n        const subscription = yield this.subscribe(createdPayload, callback);\n        return Object.assign({\n          created: createdPayload\n        }, subscription);\n      }\n      throw new Error(`Error creating payload or subscribing to created payload`);\n    });\n  }\n}\nexports.Payload = Payload;","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","Payload","debug_1","require","websocket_1","utils_1","log","debug","logWs","maxSocketConnectAttempts","jest","socketConnectAttemptSecondsDelay","socketKeepaliveSendSeconds","socketKeepaliveTimeoutSeconds","constructor","MetaObject","Meta","resolvePayload","payload","_a","_b","_c","get","uuid","meta","Error","create","returnErrors","directTx","TransactionType","txjson","call","throwIfError","isCreatedPayload","undefined","payloadUuid","isPayload","subscribe","callback","callbackPromise","DeferredPromise","payloadDetails","_u","socket","keepAlivePing","keepAliveReinstateTimer","reconnectAttempts","promise","clearTimeout","close","connect","globalThis","MockedWebSocket","w3cwebsocket","endpoint","replace","onopen","console","setInterval","send","onmessage","MessageEvent","m","data","json","JSON","parse","toString","message","setTimeout","signed","expired","updatedPayloadDetails","assign","devapp_fetched","callbackResult","resolveData","onclose","_e","code","reason","wasClean","clearInterval","resolved","websocket","cancel","fullPayload","isValidResponse","createAndSubscribe","createdPayload","subscription","created"],"sources":["C:/Users/Alex Salsali/Desktop/Eunoia-Atlas-POC/frontend/node_modules/xumm-sdk/dist/src/Payload.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Payload = void 0;\nconst debug_1 = require(\"debug\");\nconst websocket_1 = require(\"websocket\");\nconst utils_1 = require(\"./utils\");\nconst log = debug_1.debug('xumm-sdk:payload');\nconst logWs = debug_1.debug('xumm-sdk:payload:websocket');\nconst maxSocketConnectAttempts = typeof jest !== 'undefined' ? 0 : 30;\nconst socketConnectAttemptSecondsDelay = 2;\nconst socketKeepaliveSendSeconds = 2;\nconst socketKeepaliveTimeoutSeconds = 10;\nclass Payload {\n    constructor(MetaObject) {\n        log('Constructed');\n        this.Meta = MetaObject;\n    }\n    resolvePayload(payload) {\n        var _a, _b, _c;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof payload === 'string') {\n                return yield this.get(payload, true);\n            }\n            else if (typeof ((_a = payload) === null || _a === void 0 ? void 0 : _a.uuid) !== 'undefined') {\n                return yield this.get(payload.uuid, true);\n            }\n            else if (typeof ((_c = (_b = payload) === null || _b === void 0 ? void 0 : _b.meta) === null || _c === void 0 ? void 0 : _c.uuid) !== 'undefined') {\n                return payload;\n            }\n            throw new Error('Could not resolve payload (not found)');\n        });\n    }\n    create(payload, returnErrors = false) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            const directTx = typeof payload.TransactionType !== 'undefined'\n                && typeof payload.txjson === 'undefined';\n            const call = yield this.Meta.call('payload', 'POST', directTx ? { txjson: payload } : payload);\n            if (returnErrors) {\n                utils_1.throwIfError(call);\n            }\n            const isCreatedPayload = ((_a = call) === null || _a === void 0 ? void 0 : _a.next) !== undefined;\n            if (!isCreatedPayload) {\n                return null;\n            }\n            return call;\n        });\n    }\n    get(payload, returnErrors = false) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            const payloadUuid = typeof payload === 'string'\n                ? payload\n                : payload === null || payload === void 0 ? void 0 : payload.uuid;\n            const call = yield this.Meta.call('payload/' + payloadUuid, 'GET');\n            if (returnErrors) {\n                utils_1.throwIfError(call);\n            }\n            const isPayload = ((_b = (_a = call) === null || _a === void 0 ? void 0 : _a.meta) === null || _b === void 0 ? void 0 : _b.uuid) !== undefined;\n            if (!isPayload) {\n                return null;\n            }\n            return call;\n        });\n    }\n    subscribe(payload, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const callbackPromise = new utils_1.DeferredPromise();\n            const payloadDetails = yield this.resolvePayload(payload);\n            if (payloadDetails) {\n                const _u = 'undefined'; // For Jest tests\n                let socket;\n                let keepAlivePing;\n                let keepAliveReinstateTimer;\n                let reconnectAttempts = 0;\n                callbackPromise.promise.then(() => {\n                    clearTimeout(keepAlivePing);\n                    clearTimeout(keepAliveReinstateTimer);\n                    socket.close(1000);\n                });\n                const connect = () => {\n                    var _a, _b;\n                    socket = typeof ((_a = globalThis) === null || _a === void 0 ? void 0 : _a.MockedWebSocket) !== _u && typeof jest !== _u\n                        ? new ((_b = globalThis) === null || _b === void 0 ? void 0 : _b.MockedWebSocket)('ws://xumm.local')\n                        : new websocket_1.w3cwebsocket(this.Meta.endpoint.replace(/^http/, 'ws') + '/sign/' + payloadDetails.meta.uuid);\n                    socket.onopen = () => {\n                        console.log(`Payload ${payloadDetails.meta.uuid}: subscription active (WebSocket opened)`);\n                        keepAlivePing = setInterval(() => {\n                            logWs('Send keepalive');\n                            socket.send('{\"ping\":true}');\n                        }, socketKeepaliveSendSeconds * 1000);\n                    };\n                    socket.onmessage = (MessageEvent) => __awaiter(this, void 0, void 0, function* () {\n                        reconnectAttempts = 0;\n                        const m = MessageEvent.data;\n                        let json = undefined;\n                        try {\n                            json = JSON.parse(m.toString());\n                            if ((json === null || json === void 0 ? void 0 : json.message) && json.message === 'Right back at you!') {\n                                // Keepalive responses\n                                logWs('Keepalive response');\n                                clearTimeout(keepAliveReinstateTimer);\n                                keepAliveReinstateTimer = setTimeout(() => {\n                                    console.log(`WebSocket for ${payloadDetails.meta.uuid} ` +\n                                        `keepalive response timeout, assume dead... (Reconnect)`);\n                                    socket.close(1002, 'Assume dead');\n                                }, socketKeepaliveTimeoutSeconds * 1000);\n                                return;\n                            }\n                            if ((json === null || json === void 0 ? void 0 : json.signed) || (json === null || json === void 0 ? void 0 : json.expired)) {\n                                // The payload has been signed or expired, update the referenced payload\n                                const updatedPayloadDetails = yield this.resolvePayload(payload);\n                                Object.assign(payloadDetails, Object.assign({}, updatedPayloadDetails));\n                            }\n                        }\n                        catch (e) {\n                            // Do nothing\n                            logWs(`Payload ${payloadDetails.meta.uuid}: Received message, unable to parse as JSON`, e);\n                        }\n                        if (json && callback && typeof json.devapp_fetched === 'undefined') {\n                            try {\n                                // log(`Payload ${payload}`, json)\n                                const callbackResult = yield callback({\n                                    uuid: payloadDetails.meta.uuid,\n                                    data: json,\n                                    resolve(resolveData) {\n                                        return __awaiter(this, void 0, void 0, function* () {\n                                            yield callbackPromise.resolve(resolveData || undefined);\n                                        });\n                                    },\n                                    payload: payloadDetails\n                                });\n                                if (callbackResult !== undefined) {\n                                    callbackPromise.resolve(callbackResult);\n                                }\n                            }\n                            catch (e) {\n                                // Do nothing\n                                logWs(`Payload ${payloadDetails.meta.uuid}: Callback exception`, e);\n                                // This one emit for devs to know about this problem\n                                console.log(`Payload ${payloadDetails.meta.uuid}: Callback exception: ${e.message}`);\n                            }\n                        }\n                    });\n                    socket.onclose = (_e) => {\n                        logWs('Closed [code]', _e.code);\n                        logWs('Closed [reason]', _e.reason);\n                        logWs('Closed [wasClean]', _e.wasClean);\n                        clearInterval(keepAlivePing);\n                        clearTimeout(keepAliveReinstateTimer);\n                        // Reconnect\n                        if (_e.code > 1000 || _e.wasClean === false) {\n                            console.log(_e);\n                            logWs('Unhealthy disconnect, reconnecting...', _e.code);\n                            if (reconnectAttempts < maxSocketConnectAttempts) {\n                                if (reconnectAttempts === 0) {\n                                    console.log(`WebSocket for ${payloadDetails.meta.uuid} lost, reconnecting...`);\n                                }\n                                setTimeout(() => {\n                                    reconnectAttempts++;\n                                    logWs('# Reconnect');\n                                    if (typeof jest === 'undefined') {\n                                        socket = connect();\n                                    }\n                                }, socketConnectAttemptSecondsDelay * 1000);\n                            }\n                            else {\n                                if (typeof jest === 'undefined') {\n                                    console.log(`WebSocket for ${payloadDetails.meta.uuid} exceeded reconnect timeouts, give up`);\n                                }\n                            }\n                        }\n                        else {\n                            // Socket closed on purpose (?)\n                        }\n                        logWs(`Payload ${payloadDetails.meta.uuid}: Subscription ended (WebSocket closed)`);\n                    };\n                    return socket;\n                };\n                socket = connect();\n                return {\n                    payload: payloadDetails,\n                    resolve(resolveData) {\n                        callbackPromise.resolve(resolveData || undefined);\n                    },\n                    resolved: callbackPromise.promise,\n                    websocket: socket\n                };\n            }\n            utils_1.throwIfError(payloadDetails);\n            throw Error(`Couldn't subscribe: couldn't fetch payload`);\n        });\n    }\n    cancel(payload, returnErrors = false) {\n        var _a, _b, _c;\n        return __awaiter(this, void 0, void 0, function* () {\n            const fullPayload = yield this.resolvePayload(payload);\n            const call = yield this.Meta.call('payload/' + ((_a = fullPayload === null || fullPayload === void 0 ? void 0 : fullPayload.meta) === null || _a === void 0 ? void 0 : _a.uuid), 'DELETE');\n            if (returnErrors) {\n                utils_1.throwIfError(call);\n            }\n            const isValidResponse = ((_c = (_b = call) === null || _b === void 0 ? void 0 : _b.meta) === null || _c === void 0 ? void 0 : _c.uuid) !== undefined;\n            if (!isValidResponse) {\n                return null;\n            }\n            return call;\n        });\n    }\n    createAndSubscribe(payload, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const createdPayload = yield this.create(payload, true);\n            if (createdPayload) {\n                const subscription = yield this.subscribe(createdPayload, callback);\n                return Object.assign({ created: createdPayload }, subscription);\n            }\n            throw new Error(`Error creating payload or subscribing to created payload`);\n        });\n    }\n}\nexports.Payload = Payload;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}